"""
OSINT Tool Pro - Premium Features
License verification and pro-only functionality
"""

import hashlib
import json
from pathlib import Path
from datetime import datetime


# Valid license key hashes (SHA256) - 100 keys generated
VALID_LICENSE_HASHES = {'2a8b199486eb1b8ace94198b7f3c3656c41cf68368c90424f788ad44e43b4be1', 'f5d5146e59fb9b72657e5cdfaafbf7c1aa17cd2192d5e7e0ebb5233b86a2fd38', '8591ea849450ddab26a6565b8f2476b3629ed3089012298e2f9eb3bf2cb6b7cd', '3967fd29a48c94a69ebdf890f3d95fc8a873c7e8ef3b219e3edffbb732cb6e25', 'ede7c3f3e1357f7df8693a21387ce2806eb2cd4cb9f86dc62272e441e9594f86', '31c459011419d506822b351ad3d44271af5e3593c7834125b103ef72796a4736', 'c527a776de742d221e53a2bdafeec5ff9aacd409b5f081dfd8ce2a4f98e0ca1e', 'da9dce3bb14650e94a4ff21964a9e99cf6732f5b07c600e46aee1f80b93f1574', '1e11db263e950aee27d8bd57912ee46210b822a7e5c9bd2589c45f90a37be8ad', '6f355893546749934fc140de5de89dda3a8c5e9bb937867f5d9687e71a45f832', 'e2a386335b86d0c4bbddd3b00f055e232b471b8f9e995d557a8cecc4713952be', '3fb201dddc094063d3dc808e277a3817f6c061f2350ec8be29438b5a76945487', 'fb6add290eee90e4c493c1666f5fc19b567a478b2f91936b12ed23280d1e9c2d', 'a23908837d6adb9cc12c688f86fb936aeb16680f96db8ed7df718fd40353bebc', 'dc0fc9a43de1d30cc72eda8e5eb808970cabdee10bd95faaf53904f7a56f3801', '3406797fe6ce32952b082ed847c6425aef56dd67c98ecfb56061489ff81cddc7', '4283408105286af833d87febafaff0d25bf1c110000c5f872809d2c153d47890', '270a7224b3bf3c0ad1b823dc2846ccfc28ae7184f0eae033af5c01621406fb04', 'a7aca3bfae7563c65065d155121e3a1cbbafc39e5d3019937b12c9ea210f4298', 'faa2376769a488810a88764889d1070a7368b066f106a6f417e99c34d724791b', '7dd7aa9e32800eca23394697ea5110a7f6c916233d072eed1b70a1d18512803f', '91a7e238901986ca81b4af4b62db867ccedcbf6faa3ca22566b04032219a8919', '99183d10ad6533c6ba13c300019a1fe1710d389107de12765c754cdd08446935', '3ac88e2db1ce4b4523e45c50ab100df75d69434510947888f14565db9c147bf9', 'bd342d8643613bc8c70f7ed89584ab1975d79381bceca1852c49bcbbf865be6a', 'f785e3d29077142c840399c919eecaa17b3dd16a109a15a36fe67f97dd78244d', 'd147f14af74b52edd2579b6cc8208ac7460ff86892650334e38324bc896a664d', '098a7e80699679d5203462e29e9db40830bfa3ffecb32c809bc6293ad7082c6b', '3d54421d4ae9d3f2a41b0cc5edac7d33e9600d01c854891d3f7d26db15c7b49b', '87f0c2159fc36ae41613300c9d7b83a436c8e47dd203644053e5f477a091c016', '9d850719453616ce89ed3a01d3aea51b0725b5a773b71bdbd09a21eada004e88', '6b6870c702f110b1b89a22607a9fbc70a882215eb5c77ba4b046160d34fb7dc0', '2e86d227a8fc92a83efd3a3db63589864ec0bebe4dbc7786e40ecc17b56c1c8e', 'ecd3bbebdbce20f64412ff201046804e6fc140532a95bfc40b24fde715d3beb5', 'daad6be277d040d0ea9ae440a69853c370bfa3eff0b2f1b4d6fb9b19f08b5024', '2fcfa9abf4b0e29d55c06a45dfb9b28b5b01dfa375f7ce025ea12cb21b64ef4a', '8c2cd621dde96be34dc313d7b55756357382393b0f8f06558564b94d33a5528f', 'f14d37b424966258905fa665b9b9a10373fda18766c55cdbb0700187e353fe1c', '989edc84d81a3fb1b8d3c4edd11ea8f9260d8603ba0f24ba1755fe75fdd64f96', '71a665718b8cea74f4049ab3ff7e4d4619bb886c3bfadf29358f0e8c5673e293', '0427abd529f8a21a492433d3941dc4383e657b435ff30a4cb640135f2b5d0fed', 'cfebf0d68fc5d1a30f6d044ae9264757fcb55accf26ac9947a26fbd754c004e7', '994bbe775f468bf0b8f00f9c0c293cd6ab379be18f8d65a1a069fd3247b3865a', '69b72e948742ddafedabc4d2f3b0f73e619aad42ea16be6177fd6f578586e5a0', '53ba41cb259598cf6e1575f77774bbc0d0d058b44067e230a5bd8979b294a2ff', 'd2905d00a7f041f18cffef194e4b350b486654df20dce50f0937bb3e5a8fbb9f', '1e7590c7b175c3c1aaa7238a67f5b13d988897b9e2cbc6c25a15eb326f3938a7', '7e9cc12f26dd70593a32aebae47ffb89619dca8151400537106cadd871be6207', '0c8be707ccf5b408db6367e0ffad6fe7e494e0d069c93f79af27516e835db9a6', 'a3be752acf4a6afc8c94c504fcfe90415553925406632733d81fe56e234b8239', '8a46b3330e0851d387cd6b78bde342e8dd81a6929bd1825116df4d3528a84edc', '3b326c2392040f9d015bd6835261c4da03a3b3aaecbbad7fed63c6b1cae84c6a', '0c7716d4bebc1000a440aa70946f538b01696dff951524d2b62127e3b0f40493', '4da9500b4828b1558045f3b7f99024e1a8cab365d400132c7f6dd741f2074988', '07b71919cf421fa8c5e8f257b737d88f66b6761077ea9da78f8b22a1c4d19775', '1237c3871d3b9c2e5d3078d6c1daf2a33519f330edd6e9ca3352b8649c291df4', '455292bc1b472f992194be56d2f25653d9303cdde4a52b28f9f829ced222d6bd', 'ea173825df1eff9cdd4b0f9280378be95a628d615e4627a3f43454df761fe65f', 'b1421c4ab36d6a126b4c62c433e388c3cafa88829ac486b1b74f19be5a06aecf', '36f2bfb39056182851a6a49c4d0a2c03d00ce0dd8981fad0ce6728dfe0b8ca27', '05bf5ac4efd9bf3ac848033c9c100738c836ef3b1c696eba0b70e0154f963d5b', '79d097c1dea3838950c1fbeb25fc3fb6d1d578e4cff5c0f37e7267113bc3e787', '56e58f33031b91dc918cab2ca88c643dee0709e351bc2df6cea0f67bdabdd991', '7f63a602beace852b41416c574aeb4caefba5dede36983dcf5fcda5fec594e2a', '43b482b96a3483e34dc00b4772a2bd8a96cb16d664a2b5f3f5a3413be27b36ec', '2336d97e49892c02f15a1ef9f5c487502d6617637725b263a3c6f6ef4b05ac8a', '32df591eb8e63d07cded333d702d860dbb742ddcb2cb1bfec1491a900406f79b', '83cb06a1a6802976b4bd70b94b67852d69ba7145be48151539c96a24efc4f03f', '8a7035d928ab1352e0495aa9f1ffb2a30a3d21224f0d055d71af6dd45858d215', 'e9ca5c7551efa959bc01d40a58d57cde8daa3f8073fb29b233a6007814002910', '21edd852d3879803b37cba4e821f95f0c38f34f87c6cf2c18e8f9d68bd15a401', 'a31143786ee1196bea9b455ef3da32d88da0fed1d2324f9d8aac902e8f31fea8', '7ad8a887318d5ffa4a99d67d67492f9a09ef1ff367655023fd7db96a181ff767', 'a8fd6c1464a5650793e817fc75b5e99466a420d3b474589ae00f46e4c65aace3', '12afbfe730a0e19ee7b90190adc3e56b06fc87e2452ee9ebab9e4536412343fb', 'd2cbe266992113678917d0710f64f9696322fb79a99627845bbafcec6e8dafd5', '7904f06870b238f7ba7861f06b7ef9ef4803152cefc5dd71141b8ece1c8a6aa9', '7ac512642e64b183115a93765acde7f98b32ab689e356cefeb844a6dc7e0e285', '37cca857787fda506679b7f080262150af0ed08e59104a4422061fccbf2be962', '110fe6dd67f3e59b6d696d7eef159e4311217613fa5d5c861d9ecb601fc82f6b', '372371decdabb1199bef2b66b6cd77e38f027abcc268f61a4c9c35e7c6f6b977', 'e2aae3c91959c1368e002940c1632f696532c1fd0711fd1cfc71db9ee8165644', '5ee895928b508338580c211193815ecf74814ee460d02ce13010dcef376b445c', '3c7c85a6b8764b1dc9a63adec22709f9358ffc01fbf824087bdd83f3d75237f2', '1ba5f339c8b8ca7ec17f84c9cc6fd3d49268e801e60048f7def8366d40a9c4f2', '2fc10272765568d341c9a59e3d34c4b64d4918aa9a43c880bd57f9a0a776e730', '02476d2dcf1cee21ab73b0414f014272a9b7f15dfbaaad6f83b155c84f205674', '179713692190d0a9b8bd1bd788a6e929414f398baa46294a6e1dbb89318e93cd', '2a3b1dcf353fd210b5895ffd449c65ef344e30175a77adafdecee4f3f9a8af1f', '634d0278ca46a42dede438462380b8708e2ba20dc287868bb2dcb5a80bcbc890', 'fbfd7a5a2b3005864a30199eb3aacbc1476ac5a3957728a1e46e3cd059b787cd', 'a56441b5891432953a03097831b376e9b4dcc84886f7c8ff5b0de3252aa97ebc', '62d6ca5df9688a800a745b1ef2ee9ab58c92b3b40214cd808f0a1d8c8f612b32', '5ec105b290183f79b62bab3bcb7eae1e2b40ce6fc76c10d34d2ab16d653585db', '1ef74d557be20e18d0e4d96181c4900de7252f99fbaaac19389c23dcaadecd7f', 'e6babf538958b192c649f0c35b20347a335531db3fd7b3b6d305b9dabe224c5e', '65ba4105d28aa868205bec8612ba29ad255b19c5f3d9d730ff4b294bc89b1042', '1eaf83f21d68815ab8601272575eaf612546ab7eb574a4d5aefcf5c00b4a3647', '5f08821ca7824d30af736b5f1d3b1411bfa5ce5d53e2d422f9f524f8d5cc02f0', '8d7535068df291ac868e3b55445fc44cd22962e1fa694d9b763a2c56cf961539'}


class ProLicense:
    """License verification for Pro features"""
    
    def __init__(self):
        self.license_file = Path.home() / '.osint_pro_license'
        self.license_key = None
        self.is_valid = False
    
    def verify_license(self, key: str = None) -> bool:
        """Verify license key"""
        if key:
            self.license_key = key
        elif self.license_file.exists():
            with open(self.license_file, 'r') as f:
                data = json.load(f)
                self.license_key = data.get('key')
        
        if not self.license_key:
            return False
        
        # Hash-based verification against valid license keys
        key_hash = hashlib.sha256(self.license_key.encode()).hexdigest()
        
        self.is_valid = (key_hash in VALID_LICENSE_HASHES)
        return self.is_valid
    
    def save_license(self, key: str):
        """Save license key locally"""
        with open(self.license_file, 'w') as f:
            json.dump({
                'key': key,
                'activated': datetime.now().isoformat()
            }, f)
        self.license_key = key
    
    def require_pro(self):
        """Decorator to require Pro license"""
        if not self.verify_license():
            raise Exception(
                "ðŸ”’ This is a Pro feature!\n"
                "Purchase OSINT Tool Pro at: https://gumroad.com/your-product\n"
                "Or activate your license: python -m tools.osint.pro activate YOUR_KEY"
            )


# Global license instance
license_manager = ProLicense()
